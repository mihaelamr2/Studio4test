Library\\v2.0.description=The 'Http Client' does an http request and a parsing of the response. It provides features like\: http autentication, http secure, connection pool, cookies, proxy. To acomplish this it uses the third parties from Apache\: HttpClient 4.3, HttpCore 4.3. It also uses the JCIFS library from the Samba for the 'NTLM' authentication.\t\n\t\nThe operation will build for the request\:\t\n  - the URL\: composed of the 'url' input (that needs to be standard) and the 'queryParams' input (that doesn't need to be url encoded). If 'encodeQueryParams'\='false' queryParams will not get double encoded.\t\n  - the content-type\: This will be the 'contentType' input completed by 'requestCharacterSet' if that info is missing (so if you say 'contentType\=text/html' and 'charset\=utf-8' you will get the header 'Content-Type\: text/html; charset\=utf-8'. But you can also specify the whole header as input 'contentType'\='text/html; charset\=utf-8' or as input 'headers'\='Content-Type\: text/html; charset\=utf-8'). Content-type will default to 'text/html; charset\=ISO_8859_1' unless 'formParams' are specified and then it will default to 'application/x-www-form-urlencoded; charset\=ISO_8859_1'\t\n  - the request entity\: 'formParams' input has priority in building this. Then comes 'body' and then 'filePath'. The previously built 'contentType' will be taken into account.\t\n  - the headers\: This will be composed from the 'headers' input and the previously built 'contentType'. Extra, protocol specific headers will also be added the Apache Http Client api\:\t\nFor GET you will find in the request\t\n\tContent-Type\: text/plain; charset\=ISO-8859-1\n\tHost\: 16.77.58.58\:8080\n\tConnection\: Keep-Alive\n\tUser-Agent\: Apache-HttpClient/4.3.4 (java 1.5)\n\tAccept-Encoding\: gzip,deflate\nFor POST you will find in addition the Content-Length header, e.g.\:\t\n\tContent-Length\: 34\n   - the request configuration\: This includes connectionTimeout, socketTimeout, followRedirects, proxyHost and proxyPort\t\n   - the credentials provider\: This will build simple user-password credentials for basic and digest and domain-user-password credentials for ntlm. These will be asociated to the host and port in the url. The same thing will be done for proxyUsername, proxyPassword, proxyHost and  proxyPort.\t\n   - the autehntication scheme\: The action will register the Apache HTTP Client autentication scheme coresponding to the given authType. This will know how to resopond tu http ww-autenticate challenges. For NTLM it will register not the default Apache scheme but the JCIFS one.\t\n   - the cookieStore\: This is a memory object that holds all the cookies. It is taken from the session and deserialized (and created if not present). At the end of the execution it will be serialized back into the session. Because of the serializable behaviour it cannot be used in a multithreaded execution. If 'useCookies' is false the cookie store will be lost for each execution.\t\n   - the https connection\: Apache Http Client uses Java Secure Socket Extension (JSEE) and this supports SSL versions 2.0 and 3.0 and Transport Layer Security (TLS) 1.0. The operation will take into account 'trustAllRoots' , 'keystore', 'keystorePassword', 'trustKeystore' and 'trustPassword'. With trustAllRoots\=true you do not need to spcify anything else. Otherwise you may need to import the selfsigned certificates into your default keystore (<OO_Home>/java/lib/security/cacerts)  or the one specified by the 'keystore' input. 'trustKeystore' is for server side https autentication and is less used. \t\n  - the connection pool\: This will take the connection pool from the 'Global Session' and build it if it does not exist. This will allow reuse of the existing connection. If 'keepAlive' is true the currrent connection will not be closed.\t\n\nThe request will be executed. \t\n\nAnd the response will be parsed\:\t\n   - the entity will be read using the character set specified by the 'responseCharacterSet'. If no 'responseCharacterSet' present, the charset from the content-type from the response headers will be used. Otherwise charset will default to 'ISO_8859_1'. If 'destinationFile' is specified the entity content will go there, if not it will go to the 'returnResult' output.\t\n\nMore details about Http Client inputs\:\n    queryParamsAreFormEncoded - Specifies whether to encode the queryParams in the the default format used by the apache http client library - form format. If queryParamsAreFormEncoded\=true then all characters will be encoded based on the queryParamsAreURLEncoded input. If queryParamsAreFormEncoded\=false all reserved characters are not encoded no matter of queryParamsAreURLEncoded input. The only exceptions are for ' ' (space) character which is encoded as %20 in both cases of queryParamsAreURLEncoded input and + (plus) which is encoded as %20 if queryParamsAreURLEncoded\=true and not encoded if queryParamsAreURLEncoded\=false. If the special characters are already encoded and queryParamsAreURLEncoded\=true then they will be transformed into their original format. For example\: %40 will be @, %2B will be +. But %20 (space) will not be transformed. The list of reserved chars is\: ;/?\:@&\=+,$\nExample\: for a value in the queryParams input of\: query\=test te%20@st th request will be encoded in query\=test%20te%20@st\n\n    multipartBodies - The request entity should look like\:\nContent-Disposition\: form-data; name\="name1"\nContent-Type\: text/plain; charset\=UTF-8\nContent-Transfer-Encoding\: 8bit\t\ntextvalue1\nExamples\: name1\=textvalue1&name2\=textvalue2\n\n    multipartFiles - The request entity should look like\:\nContent-Disposition\: form-data; name\="name3"; filename\="readme.txt"\nContent-Type\: application/octet-stream; charset\=UTF-8\nContent-Transfer-Encoding\: binary the text in readme.txt\nExamples\: name3\=c\:\\temp\\readme.txt&name4\=c\:\\temp\\log4j.properties\n\nMore details about Http Client outputs\:\n    reasonPhrase - The reason phrase from the origin HTTP response.\nExamples\: (HTTP 1.0)\: OK, Created, Accepted, No Content, Moved Permanently, Moved Temporarily, Not Modified, Bad Request, Unauthorized, Forbidden, Not Found, Internal Server Error, Not Implemented, Bad Gateway, Service Unavailable\tValues (HTTP 1.1)\: Continue, Temporary Redirect, Method Not Allowed, Conflict, Precondition Failed, Request Too Long, Request-URI Too Long, Unsupported Media Type, Multiple Choices, See Other, Use Proxy, Payment Required, Not Acceptable, Proxy Authentication Required, Request Timeout, Switching Protocols, Non Authoritative Information, Reset Content, Partial Content, Gateway Timeout, Http Version Not Supported, Gone, Length Required, Requested Range Not Satisfiable, Expectation Failed\n\nOther notes\n1. You can use KeyTool from <OO_Home>/java/bin to import a SSL certificate in a KeyStore. For example, to import a certificate in the Java cacerts KeyStore, run the following command from the KeyTool folder\: keytool -import -file c\:/../<your_cert>.cer -alias <your_alias> -keystore <OO_Home>/java/lib/security/cacerts. If the KeyStore does not exist, the command tries to create a new one containing only your certificate.\n2. You can use KeyTool to create a certificate chain through the following command\: \n   keytool -genkey -dname "cn\=Mark Jones, ou\=JavaSoft, o\=Sun, c\=US" \n      -alias business -keypass kpi135 -keystore C\:\\working\\mykeystore \n      -storepass ab987c -validity 180\nThis creates a certificate chain in a new KeyStore containing only one certificate. It is useful in SSL client authentication because the KeyManager ignores any certificates not included in a certificate chain.\n3. If the value assigned to the <trustAllRoots> input is 'false' and <trustKeystore> is empty, the operation tries to use the default trust store, using the password "changeit". \n4. If the authentication type is Kerberos, you might need to add an SPN (Service Principal Name) for the web server's computer account.  In order to do this, you can use ADUC (Active Directory Users and Computers) with enabled 'Advanced Features'. Go to the web server's computer account (example\: CN\=<web_server_name>,CN\=Computers,DC\=domain,DC\=com), open the 'Properties' window and press the 'Attribute Editor' tab. Observe the values of the 'servicePrincipalName' attribute and add your SPN if not present. For example, HTTP/<web_server_FQDN>\:port.\n5. If you need to specify query parameters when making the request, use the <queryParams> input. The operation also accepts including query parameters in the URL. For example, http\://hostname\:80/page.asp?parameterName1\=parameterValue1&parameterName2\=parameterValue2. If you specify the same query parameter both through the <queryParams> and the <url> inputs, the url build will contain the query parameter twice with the two values.\n6. Notes about the Kerberos authentication\n\nThe simplest way to use Kerberos authentication is to write the URL using a FQDN and specify the username and password that has access to that resource. The OO service running this operation should be run as that user.  Following the example is the explanation about how the operation works in this use case.\n\tExample 1 inputs\:\n\turl->http\://mywebserver.contoso.com\n\tauthType->kerberos\n\tusername->Administrator\n\tpassword->******\n\tmethod->GET\n\nKerberos authentication is built into JRE and needs two configuration files, as specified by the JAAS framework, and the Kerberos mechanism required by the Java GSS-API methods. These will be created by the operation as temporary files if the 'kerberosConfFile' and 'kerberosLoginConfFile' inputs are not specified. The corresponding java system properties 'java.security.krb5.conf' and 'java.security.auth.login.config' will also be set to the above file paths. The domain name will be obtained from the 'url' input, from the host part.\n\nCreated temporary files on a windows machine will be like these\:\nc\:\\Users\\Administrator.CONTOSO\\AppData\\Local\\Temp\\2\\krb2289023294434647612kdc \n\t[libdefaults]\n\t\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 default_realm \= CONTOSO.COM\n\t[realms]\n\t\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 CONTOSO.COM \= {\n\t\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 kdc \= contoso.com\n\t\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 admin_server \= contoso.com\n\t\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0\u00A0 }\nc\:\\Users\\Administrator.HPOO\\AppData\\Local\\Temp\\2\\krb6566019897713925126loginConf \n\tcom.sun.security.jgss.initiate {\n\t\tcom.hp.score.content.httpclient.build.KrbHttpLoginModule required\n\t\tdoNotPrompt\=true;\n\t};\n\nNote that the operation's 'com.hp.score.content.httpclient.build.KrbHttpLoginModule' extends the java standard 'com.sun.security.auth.module.Krb5LoginModule' in order to provide the given username and password. The operation will use the specified 'username' and 'password' to get a TGT similar to what the command line tool '<OO instalation>/java/bin/kinit' does when no keytab exists.\n\n\nAnother use case is to specify 'kerberosConfFile' and 'kerberosLoginConfFile' paths and use a keytab instead of 'username' and 'password' to get a TGT. To configure you machine\n\t1. Generate a keytab use the ktab command line like\:\n'<OO instalation>/java/bin/ktab -a Administrator password'. On windows a keytab file will be created\: C\:\\Users\\Administrator.CONTOSO\\krb5.keytab\n\n\t2. Write a krb5.conf file with content similar to (where you replace CONTOSO.COM with your domain and 'ad.contoso.com' with your kdc FQDN. More info here\: http\://web.mit.edu/kerberos/krb5-1.4/krb5-1.4.4/doc/krb5-admin/krb5.conf.html)\:\n\t[libdefaults]\n\t\tdefault_realm \= CONTOSO.COM\n\t[realms]\n\t\tCONTOSO.COM \= {\n\t\t\tkdc \= ad.contoso.com\n\t\t\tadmin_server \= ad.contoso.com\n\t\t}\n\n\t3. Write a login.conf file with the content (more info here\: http\://docs.oracle.com/javase/7/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html )\t\n\tcom.sun.security.jgss.initiate {\n\t\tcom.sun.security.auth.module.Krb5LoginModule required principal\=Administrator \n\t\tdoNotPrompt\=true\n\t\tuseKeyTab\=true\n\t\tkeyTab\="file\:/C\:/Users/Administrator.CONTOSO/krb5.keytab";\n\t};\n\n\t4. Configure operation inputs like this\n\t\tExample 2 inputs\:\n\t\turl->http\://mywebserver.contoso.com\n\t\tauthType->kerberos\n\t\tkerberosConfFile->c\:/OO/krb5.conf\n\t\tkerberosLoginConfFile->c\:/OO/login.conf\n\t\tmethod->GET\n
