Library\\PowerShell\\Cross\ Platform.description=This folder contains a PowerShell operations and flows that can run also on a Linux worker (Cross platform \u2013 Windows or Linux). The cross platform capabilities are enabled through the Windows Remote Management implementation of WS-Management Protocol.\n\nPowerShell must be installed and configured on the host computer before any of the available operations are executed. The PowerShell Script operation uses the Windows Remote Management (WinRM) implementation for WS-Management standard to execute PowerShell scripts and is designed to run on remote hosts. Please consult the PowerShell folder\u2019s descriptions for information about PowerShell installation and configuration.\n\nInterfaces/APIs Used\:\nWinRM\n\nTo configure PowerShell remoting through WinRM do the following\:\n\nwinrm quickconfig\nThis command will start the WinRM service, and set the service startup type to auto-start. Configure a listener for the ports that send and receive WS-Management protocol messages using either HTTP or HTTPS on any IP address.\nOpen the ports for HTTP(5985) and HTTPS(5986). The winrm quickconfig command creates a firewall exception only for the current user profile. \n\nManualy Enable the WinRM firewall exception if winrm quickconfig did not work\:\nnetsh advfirewall firewall add rule name\="WinRM-HTTP" dir\=in localport\=5985 protocol\=TCP action\=allow\n\nTo configure winrm basic authentication and allow unencrypted communication with clients\:\nwinrm set winrm/config/service/auth '@{Basic\="true"}'\nwinrm set winrm/config/service '@{AllowUnencrypted\="true"}'\nwinrm set winrm/config/client @{TrustedHosts\="RemoteComputerName"}\n\nRun this command to check your configurations\:\nWinrm get Winrm/config\n\nConfiguring WinRM for HTTPS\:\nWinRM HTTPS requires a local computer "Server Authentication" certificate with a CN matching the hostname, that is not expired, revoked, or self-signed to be installed.\nTo install or view certificates for the local computer\:\n- click Start, run, MMC, "File" menu, "Add or Remove Snap-ins" select "Certificates" and click "Add".  Go through the wizard selecting "Computer account".  \n- Install or view the certificates under\:\nCertificates (Local computer)\n    Personal\n        Certificates\n\nIf you do not have a certificate under the specified location, you should create and install a certificate with a CN matching the hostname, that is not expired, revoked, or self-signed to be installed.\nOnce the certificate is installed type the following to configure WINRM to listen on HTTPS\:\nwinrm quickconfig -transport\:https\n\nUse the following command to enumerate the winrm configured listeners. You should have one for http listening on 5985 and one for https listening on 5986\:\nwinrm e winrm/config/listener \n\nUse netstat -ano | findstr "5985" and netstat -ano | findstr "5986" to check if the ports are opened.\n
